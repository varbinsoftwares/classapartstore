var resetMultiInputIndex,addMultiInputProperty,removed_person_types=[],removed_variations=[];jQuery(document).ready(function(e){var t=function(e){return e.is(".processing")||e.parents(".processing").length};e.isFunction(e.fn.singleProductMulipleVendor)&&(e("#product_manager_form input[name=title]").singleProductMulipleVendor({ajaxurl:woocommerce_params.ajax_url,is_admin:!1}),e("body").on("click","#wcmp_auto_suggest_product_title ul li a",function(){var i;i=e("#product_manager_form"),t(i)||i.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var a={action:"wcmp_create_duplicate_product",product_id:e(this).data("product_id")};e.post(woocommerce_params.ajax_url,a,function(t){e("#product_manager_form").removeClass("processing").unblock(),t.status&&(window.location.href=t.redirect_url)})})),e("#frontend_product_manager_accordion").accordion({heightStyle:"content",collapsible:!0,activate:function(e,t){t.newHeader.hasClass("variations")&&resetVariationsAttributes()}}),e("#product_cats").select2({placeholder:product_manager_messages.choose}),e(".product_taxonomies").select2({placeholder:product_manager_messages.choose}),e("#upsell_ids").select2({placeholder:product_manager_messages.choose}),e("#crosssell_ids").select2({placeholder:product_manager_messages.choose}),e(".manage_stock_ele").change(function(){e(this).is(":checked")?(e(this).parents(".pro_ele_block").first().find(".stock_qty_wrapper").removeClass("non_stock_ele_hide"),e(this).parents(".pro_ele_block").first().find(".backorders_wrapper").removeClass("non_stock_ele_hide")):(e(this).parents(".pro_ele_block").first().find(".stock_qty_wrapper").addClass("non_stock_ele_hide"),e(this).parents(".pro_ele_block").first().find(".backorders_wrapper").addClass("non_stock_ele_hide"))});var i=["simple"];function a(){return $is_valid=!0,e(".woocommerce-error,.woocommerce-message").remove(),0==e.trim(e("#product_manager_form").find("#title").val()).length&&($is_valid=!1,e("#product_manager_form").prepend('<div class="woocommerce-error" tabindex="-1">'+product_manager_messages.no_title+"</div>"),e(".woocommerce-error").focus()),$is_valid}function o(e){var t,i=e;if("undefined"==typeof tinyMCE){(a=jQuery("textarea#"+i)).length>0&&a.is(":visible")&&(t=a.val())}else{var a;tinyMCE.get(i);(a=jQuery("textarea#"+i)).length>0&&a.is(":visible")?t=a.val():(tinyMCE.triggerSave(),t=a.val())}return t}e("#product_type").length>0?(e("#product_type").change(function(t){void 0!==t.originalEvent&&(e("#frontend_product_manager_accordion").accordion("option","active",0),e("#frontend_product_manager_accordion").accordion("refresh"));var a=e(this).val();e(".pro_ele_head").addClass("pro_head_hide"),e(".pro_ele_block").addClass("pro_block_hide"),e(".pro_ele").addClass("pro_ele_hide"),e(".frontend_product_manager_product_types > .description").addClass("pro_ele_hide"),e("."+a).removeClass("pro_ele_hide pro_block_hide pro_head_hide"),"simple"==a&&e(".frontend_product_manager_product_types > .description").removeClass("pro_ele_hide"),e("#is_downloadable").change(),-1==e.inArray(a,i)&&(e(".simple").removeClass("pro_ele_hide pro_block_hide pro_head_hide"),e(".non-"+a).addClass("pro_ele_hide pro_block_hide pro_head_hide")),e(document.body).trigger("product_type_changed")}).change(),e("#is_downloadable").change(function(){e(this).is(":checked")?e(".downlodable").removeClass("pro_ele_hide pro_block_hide pro_head_hide"):e(".downlodable").addClass("pro_ele_hide pro_block_hide pro_head_hide")}).change(),e(".is_downloadable_hidden").change(function(){"enable"==e(this).val()?e(".downlodable").removeClass("pro_ele_hide pro_block_hide pro_head_hide"):e(".downlodable").addClass("pro_ele_hide pro_block_hide pro_head_hide")}).change(),0==e("#is_downloadable").length&&e(".downlodable").addClass("downloadable_ele_hide"),e("#is_virtual").change(function(){e(this).is(":checked")?e(".nonvirtual").addClass("pro_ele_hide pro_block_hide pro_head_hide"):e(".nonvirtual").removeClass("pro_ele_hide pro_block_hide pro_head_hide")}).change(),e(".is_virtual_hidden").change(function(){"enable"==e(this).val()?e(".nonvirtual").addClass("pro_ele_hide pro_block_hide pro_head_hide"):e(".nonvirtual").removeClass("pro_ele_hide pro_block_hide pro_head_hide")}).change()):(e(".pro_ele_head").addClass("pro_head_hide"),e(".pro_ele_block").addClass("pro_block_hide"),e(".pro_ele").addClass("pro_ele_hide")),e(".dc_datepicker").each(function(){e(this).datepicker({dateFormat:e(this).data("date_format"),changeMonth:!0,changeYear:!0})}),e("#sale_date_from").datepicker({changeMonth:!0,changeYear:!0,dateFormat:"yy-mm-dd",onClose:function(t){e("#sale_date_upto").datepicker("option","minDate",t)}}),e("#sale_date_upto").datepicker({changeMonth:!0,changeYear:!0,dateFormat:"yy-mm-dd",onClose:function(t){e("#sale_date_from").datepicker("option","maxDate",t)}}),addMultiInputProperty=function(t){var i=t.data("limit");void 0===i&&(i=-1),1==t.children(".multi_input_block").length&&t.children(".multi_input_block").children(".remove_multi_input_block").css("display","none"),t.children(".multi_input_block").length==i?t.find(".add_multi_input_block").hide():t.find(".add_multi_input_block").show(),t.children(".multi_input_block").each(function(){e(this)[0]!=t.children(".multi_input_block:last")[0]&&e(this).children(".add_multi_input_block").remove()}),t.children(".multi_input_block").find(".add_multi_input_block").off("click").on("click",function(){var a=t.attr("id"),o=t.data("name"),r=e(this).parent().find(".multi_input_block_element").attr("id").split("_").pop();r++;var n=t.children(".multi_input_block:first").clone(!1);n.find("textarea,input:not(input[type=button],input[type=submit],input[type=checkbox],input[type=radio])").val(""),n.find("input[type=checkbox]").attr("checked",!1),n.find(".dc-wp-fields-uploader,.multi_input_block_element:not(.multi_input_holder)").each(function(){var t=e(this),i=t.data("name");if(t.hasClass("dc-wp-fields-uploader")){var n=t;i=n.find(".multi_input_block_element").data("name"),n.find("a span").css("display","none"),n.find("a").attr("id",a+"_"+i+"_"+r+"_display"),n.find("img").attr("src","").attr("id",a+"_"+i+"_"+r+"_display").addClass("placeHolder").css("display","inline-block"),n.find(".multi_input_block_element").attr("id",a+"_"+i+"_"+r).attr("name",o+"["+r+"]["+i+"]"),n.find(".upload_button").attr("id",a+"_"+i+"_"+r+"_button").show(),n.find(".remove_button").attr("id",a+"_"+i+"_"+r+"_remove_button").hide(),addDCUploaderProperty(n)}else t.attr("name",o+"["+r+"]["+i+"]"),t.attr("id",a+"_"+i+"_"+r),t.parent().parent().find(".checkbox_title").attr("for",o+"_"+i+"_"+r);t.hasClass("dc_datepicker")?t.removeClass("hasDatepicker").datepicker({dateFormat:t.data("date_format"),changeMonth:!0,changeYear:!0}):t.hasClass("time_picker")&&(e(".time_picker").timepicker("remove").timepicker({step:15}),t.timepicker("remove").timepicker({step:15}))}),n.find(".multi_input_holder").each(function(){!function t(i,a,o,r){i.children(".multi_input_block:not(:last)").remove();var n=i.attr("id");n=n.replace(a+"_","");var d=n.split("_");var _="";for(var l=0;l<d.length-1;l++)""!=_&&(_+="_"),_+=d[l];i.attr("data-name",o+"["+r+"]["+_+"]");i.attr("id",a+"_"+_+"_"+r);i.children(".multi_input_block").find(".dc-wp-fields-uploader,.multi_input_block_element:not(.multi_input_holder)").each(function(){var t=e(this),i=t.data("name");if(t.hasClass("dc-wp-fields-uploader")){var n=t;i=n.find(".multi_input_block_element").data("name"),n.find("img").attr("src","").attr("id",a+"_"+i+"_"+r+"_display").addClass("placeHolder"),n.find(".multi_input_block_element").attr("id",a+"_"+_+"_"+r+"_"+i+"_0").attr("name",o+"["+r+"]["+_+"][0]["+i+"]"),n.find(".upload_button").attr("id",a+"_"+i+"_"+r+"_button").show(),n.find(".remove_button").attr("id",a+"_"+i+"_"+r+"_remove_button").hide(),addDCUploaderProperty(n)}else{var d=t.attr("multiple");void 0!==d&&!1!==d?t.attr("name",o+"["+r+"]["+_+"][0]["+i+"][]"):t.attr("name",o+"["+r+"]["+_+"][0]["+i+"]"),t.attr("id",a+"_"+_+"_"+r+"_"+i+"_0")}t.hasClass("dc_datepicker")?t.removeClass("hasDatepicker").datepicker({dateFormat:t.data("date_format"),changeMonth:!0,changeYear:!0}):t.hasClass("time_picker")&&(e(".time_picker").timepicker("remove").timepicker({step:15}),t.timepicker("remove").timepicker({step:15}))});addMultiInputProperty(i);i.children(".multi_input_block").children(".multi_input_holder").length>0&&i.children(".multi_input_block").css("padding-bottom","40px");i.children(".multi_input_block").children(".multi_input_holder").each(function(){t(e(this),a+"_"+_+"_0",o+"["+r+"]["+_+"]",0)})}(e(this),a,o,r)}),n.children(".remove_multi_input_block").off("click").on("click",function(){var t=e(this).parent().parent(),a=t.children(".multi_input_block").children(".add_multi_input_block").clone(!0);e(this).parent().remove(),t.children(".multi_input_block").children(".add_multi_input_block").remove(),t.children(".multi_input_block:last").append(a),t.children(".multi_input_block").length==i?t.find(".add_multi_input_block").hide():t.find(".add_multi_input_block").show(),1==t.children(".multi_input_block").length&&t.children(".multi_input_block").children(".remove_multi_input_block").css("display","none")}),n.children(".add_multi_input_block").remove(),t.append(n),t.children(".multi_input_block:last").append(e(this)),t.children(".multi_input_block").length>1&&t.children(".multi_input_block").children(".remove_multi_input_block").css("display","block"),t.children(".multi_input_block").length==i?t.find(".add_multi_input_block").hide():t.find(".add_multi_input_block").show(),t.data("length",r)}),t.hasClass("multi_input_block_element")||t.children(".multi_input_block").css("padding-bottom","40px"),t.children(".multi_input_block").children(".multi_input_holder").length>0&&t.children(".multi_input_block").css("padding-bottom","40px"),t.children(".multi_input_block").children(".remove_multi_input_block").off("click").on("click",function(){var t=e(this).parent().parent(),a=t.children(".multi_input_block").children(".add_multi_input_block").clone(!0);e(this).parent().find(1==e('input[data-name="is_taxonomy"]').data("name"))&&($taxonomy=e(this).parent().find(e('input[data-name="tax_name"]')).val(),e("select.fpm_attribute_taxonomy").find('option[value="'+$taxonomy+'"]').removeAttr("disabled")),e(this).parent().remove(),t.children(".multi_input_block").children(".add_multi_input_block").remove(),t.children(".multi_input_block:last").append(a),1==t.children(".multi_input_block").length&&t.children(".multi_input_block").children(".remove_multi_input_block").css("display","none"),t.children(".multi_input_block").length==i?t.find(".add_multi_input_block").hide():t.find(".add_multi_input_block").show()})},e(".multi_input_holder").each(function(){var t=e(this);addMultiInputProperty(t)}),resetMultiInputIndex=function(t){var i=t.attr("id"),a=t.data("name"),o=0;t.find(".multi_input_block").each(function(){e(this).find(".dc-wp-fields-uploader,.multi_input_block_element:not(.multi_input_holder)").each(function(){var t=e(this),r=t.data("name");if(t.hasClass("dc-wp-fields-uploader")){var n=t;r=n.find(".multi_input_block_element").data("name"),n.find("img").attr("id",i+"_"+r+"_"+o+"_display").addClass("placeHolder"),n.find(".multi_input_block_element").attr("id",i+"_"+r+"_"+o).attr("name",a+"["+o+"]["+r+"]"),n.find(".upload_button").attr("id",i+"_"+r+"_"+o+"_button").show(),n.find(".remove_button").attr("id",i+"_"+r+"_"+o+"_remove_button").hide(),n.find("#"+i+"_"+r+"_"+o).val()&&(n.find("#variations_image_"+o+"_button").hide(),n.find("#variations_image_"+o+"_remove_button").show())}else{var d=t.attr("multiple");void 0!==d&&!1!==d?t.attr("name",a+"["+o+"]["+r+"][]"):t.attr("name",a+"["+o+"]["+r+"]"),t.attr("id",i+"_"+r+"_"+o)}}),e(".checkbox_title").each(function(){e(this).attr("for",e(this).next().find(".multi_input_block_element").attr("id"))}),o++})},e("button.fpm_add_attribute").on("click",function(){var t=e("select.fpm_attribute_taxonomy").val();if(t){var i={action:"generate_taxonomy_attributes",taxonomy:t};e("#attributes").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e.ajax({type:"POST",url:woocommerce_params.ajax_url,data:i,success:function(t){t&&($response=e(t),e("#attributes").append($response.find(".multi_input_block")),addMultiInputProperty(e("#attributes")),resetMultiInputIndex(e("#attributes")),e("#product_type").change(),e("#attributes").find(".multi_input_block:last").find("select").select2({placeholder:product_manager_messages.search_attribute}),e("#attributes").find(".multi_input_block:last").find("input[type=checkbox]").each(function(){e(this).wrap('<span class="checkbox-holder"></span>'),e(".checkbox-holder").append('<i class="wcmp-font ico-uncheckbox-icon"></i>')}))}})}return t&&(e("select.fpm_attribute_taxonomy").find('option[value="'+t+'"]').attr("disabled","disabled"),e("select.fpm_attribute_taxonomy").val("")),e("#attributes").unblock(),!1}),e("#select_attributes").length>0&&(e("#attributes").append(e("#select_attributes").html()),e("#select_attributes").remove(),addMultiInputProperty(e("#attributes")),resetMultiInputIndex(e("#attributes")),e("#attributes").find(".multi_input_block").find("select").select2({placeholder:product_manager_messages.search_attribute})),e("#attributes").find(".multi_input_block").each(function(){e(this).find(1==e('input[data-name="is_taxonomy"]').data("name"))&&($taxonomy=e(this).find(e('input[data-name="tax_name"]')).val(),e("select.fpm_attribute_taxonomy").find('option[value="'+$taxonomy+'"]').attr("disabled","disabled"))}),$default_attributes=e('input[data-name="default_attributes_hidden"]'),$default_attributes.length>0&&($default_attributes_val=$default_attributes.val(),$default_attributes_val.length>0&&e.each(e.parseJSON($default_attributes_val),function(t,i){e(".default_attributes_holder").append('<input type="hidden" name="default_attribute_'+t+'" data-name="default_attribute_'+t+'" value="'+i+'" />')})),e("#pruduct_manager_draft_button").click(function(t){if(t.preventDefault(),$is_valid=a(),$is_valid){e(this).prop("disabled",!0),e("#pruduct_manager_submit_button").prop("disabled",!0),e("#product_manager_form").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e("#product_manager_form").find(":input:disabled").removeAttr("disabled");var i=o("description"),r=o("excerpt"),n={action:"frontend_product_manager",product_manager_form:e("#product_manager_form").serialize(),description:i,excerpt:r,status:"draft",removed_variations:removed_variations,removed_person_types:removed_person_types};e.post(woocommerce_params.ajax_url,n,function(t){e(this).prop("disabled",!1),e("#pruduct_manager_submit_button").prop("disabled",!1),t&&($response_json=e.parseJSON(t),$response_json.status?"0"==$response_json.is_new?(e(".woocommerce-error,.woocommerce-message").remove(),e("#product_manager_form").prepend('<div class="woocommerce-message" tabindex="-1">'+$response_json.message+"</div>"),e(".woocommerce-message").focus()):window.location=$response_json.redirect:(e(".woocommerce-error,.woocommerce-message").remove(),e("#product_manager_form").prepend('<div class="woocommerce-error" tabindex="-1">'+$response_json.message+"</div>"),e(".woocommerce-error").focus()),$response_json.id&&e("#pro_id").val($response_json.id),e("#product_manager_form").unblock())})}}),e("#pruduct_manager_submit_button").click(function(t){if(t.preventDefault(),$is_valid=a(),$is_valid){e(this).prop("disabled",!0),e("#pruduct_manager_draft_button").prop("disabled",!0),e("#product_manager_form").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e("#product_manager_form").find(":input:disabled").removeAttr("disabled");var i=o("description"),r=o("excerpt"),n={action:"frontend_product_manager",product_manager_form:e("#product_manager_form").serialize(),description:i,excerpt:r,status:"submit",removed_variations:removed_variations,removed_person_types:removed_person_types};e.post(woocommerce_params.ajax_url,n,function(t){e(this).prop("disabled",!1),e("#pruduct_manager_draft_button").prop("disabled",!1),t&&($response_json=e.parseJSON(t),$response_json.status?"0"==$response_json.is_new?(e(".woocommerce-error,.woocommerce-message").remove(),e("#product_manager_form").prepend('<div class="woocommerce-message" tabindex="-1">'+$response_json.message+"</div>"),e(".woocommerce-message").focus()):window.location=$response_json.redirect:(e(".woocommerce-error,woocommerce-message").remove(),e("#product_manager_form").prepend('<div class="woocommerce-error" tabindex="-1">'+$response_json.message+"</div>"),e(".woocommerce-error").focus()),$response_json.id&&e("#pro_id").val($response_json.id),e("#product_manager_form").unblock())})}})});